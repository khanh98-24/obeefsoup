@model OBeefSoup.Models.ViewModels.HomeViewModel
@{
    ViewData["Title"] = "Trang chủ";
}

<style>
    /* ===== MOBILE BANNER FIX ===== */
    @@media (max-width: 767.98px) {
        #bannerCarousel {
            height: 55vw !important;
            min-height: 220px !important;
            max-height: 350px !important;
        }
        #bannerCarousel .carousel-inner,
        #bannerCarousel .carousel-item,
        #bannerCarousel .banner-slide {
            height: 100% !important;
            min-height: unset !important;
            max-height: unset !important;
        }
        #bannerCarousel .banner-slide {
            background-size: cover !important;
            background-position: center center !important;
        }
    }

    
    /* Brand Colors & Readability Polish */
    .section-title {
        color: #8B0000 !important;
        text-shadow: none;
        position: relative;
        z-index: 2;
        font-weight: 800;
    }
    .section-subtitle {
        color: #dc3545 !important;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-size: 0.85rem;
    }
    


    .menu-section {
    }
    .menu-card {
        border: none;
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        border-radius: 12px;
        background: #fff;
    }
    .menu-card-title {
        font-size: 1.1rem;
        font-weight: 700;
        margin-bottom: 0.4rem;
    }
    .menu-card-description {
        font-size: 0.85rem;
        color: #666;
        margin-bottom: 0.8rem;
        height: 2.5rem;
        overflow: hidden;
    }
    .menu-card-price {
        color: #8B0000 !important;
        font-weight: 700;
        font-size: 1.1rem;
    }

    .testimonials-section {
    }
    .testimonial-card {
        border: none;
        border-radius: 20px;
        background: rgba(255, 255, 255, 0.7) !important;
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
        border: 1px solid rgba(255, 255, 255, 0.3) !important;
        padding: 30px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.05) !important;
        color: #333 !important;
    }
    
    .cta-section {
        padding: 80px 0; /* Thu nhỏ từ 160px */
        background: transparent !important; /* Bỏ ảnh nền cứng */
        position: relative;
        color: white;
        overflow: hidden;
    }
    @@media (max-width: 768px) {
        .cta-section {
            padding: 50px 0 !important; /* Thu nhỏ từ 100px */
            background-attachment: scroll !important; /* Fix broken background on mobile */
            background-position: center center !important;
            background-size: cover !important;
        }
        .cta-box {
            padding: 40px 20px !important;
        }
    }
    .cta-overlay {
        position: absolute;
        top: 0; left: 0; width: 100%; height: 100%;
        background: linear-gradient(135deg, rgba(139, 26, 26, 0.45) 0%, rgba(184, 134, 11, 0.2) 100%);
        backdrop-filter: blur(5px);
        z-index: 1;
    }
    .cta-box {
        position: relative;
        z-index: 2;
        max-width: 600px; /* Thu nhỏ từ 800px */
        margin: 0 auto;
        padding: 40px 30px; /* Thu nhỏ từ 60px 40px */
        background: rgba(26, 15, 10, 0.3);
        border: 1px solid rgba(197, 160, 40, 0.3);
        border-radius: 30px;
        backdrop-filter: blur(10px);
        box-shadow: 0 25px 50px rgba(0,0,0,0.3);
    }
    .cta-divider {
        width: 60px;
        height: 2px;
        background: var(--gradient-gold);
        margin: 0 auto 30px;
    }
    .cta-title {
        font-family: var(--font-heading);
        font-weight: 700;
        font-style: italic;
        font-size: clamp(2rem, 5vw, 2.8rem); /* Nhỏ lại chút */
        color: #fff !important;
        margin-bottom: 25px;
        line-height: 1.2;
        letter-spacing: -0.5px;
    }
    .cta-subtitle {
        font-family: var(--font-body);
        font-size: 0.9rem; /* Nhỏ lại từ 1.1rem */
        text-transform: uppercase;
        letter-spacing: 3px;
        color: var(--color-secondary);
        margin-bottom: 15px;
        display: block;
        position: relative;
        z-index: 2;
    }
    

    .btn-premium-gold {
        background: var(--gradient-gold);
        color: var(--color-dark) !important;
        border: none;
        padding: 18px 45px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 2px;
        border-radius: 100px;
        transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
        box-shadow: 0 10px 25px rgba(197, 160, 40, 0.3);
        position: relative;
        overflow: hidden;
    }
    .btn-premium-gold:hover {
        transform: translateY(-5px) scale(1.05);
        box-shadow: 0 20px 40px rgba(197, 160, 40, 0.5);
        color: #000 !important;
    }
    .btn-premium-gold::before {
        content: '';
        position: absolute;
        top: 0; left: -100%; width: 100%; height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
        transition: 0.6s;
    }
    .btn-premium-gold:hover::before {
        left: 100%;
    }

    /* ===== HOVER EFFECTS POLISH ===== */
    .feature-box, .menu-card, .why-card, .store-info-card, .testimonial-card {
        transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
        cursor: pointer;
    }

    /* About Feature Box Hover */
    .feature-box:hover {
        transform: translateY(-5px);
        border-color: var(--color-secondary) !important;
        background: rgba(255, 255, 255, 0.8) !important;
        box-shadow: 0 10px 20px rgba(0,0,0,0.08);
    }

    /* Menu Card Hover */
    .menu-card {
        overflow: hidden;
    }
    .menu-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 20px 40px rgba(0,0,0,0.12) !important;
    }
    .menu-card:hover .menu-card-image img {
        transform: scale(1.1);
    }
    .menu-card-image img {
        transition: transform 0.6s cubic-bezier(0.165, 0.84, 0.44, 1);
    }



    /* Store Info Card Hover */
    .store-info-card:hover {
        transform: translateY(-5px);
        border-color: var(--color-secondary) !important;
        box-shadow: 0 12px 25px rgba(0,0,0,0.1) !important;
    }

    /* Testimonial Card Hover */
    .testimonial-card:hover {
        transform: translateY(-5px);
        background: rgba(255, 255, 255, 0.9) !important;
        border-color: var(--color-secondary) !important;
        box-shadow: 0 15px 35px rgba(0,0,0,0.1) !important;
        backdrop-filter: blur(20px);
    }

    /* MOBILE REDESIGN 2026 (max-width: 768px) */
    @@media (max-width: 768px) {
        /* Reduce hover intensity for mobile to avoid jumping */
        .feature-box:hover, .menu-card:hover, .why-card:hover, .store-info-card:hover, .testimonial-card:hover {
            transform: translateY(-3px);
        }
        .container {
            padding-left: 10px !important;
            padding-right: 10px !important;
        }
        .section-header {
            margin-bottom: 2rem !important;
            text-align: center;
        }
        .section-title {
            font-size: 1.8rem !important;
            line-height: 1.2;
        }
        .col-4 {
            padding-left: 4px !important;
            padding-right: 4px !important;
        }
        .menu-card-body {
            padding: 0.8rem 0.5rem !important;
        }
        .menu-card-image {
            height: 100px !important;
        }
        .menu-card-title {
            font-size: 0.75rem !important;
            min-height: 2.5em !important;
        }
        .menu-card-price {
            font-size: 0.85rem !important;
        }
        .about-image-wrapper {
            margin-bottom: 20px;
        }
    }

    /* ===== VISIT US TABS VISIBILITY FIX ===== */
    .visit-section .nav-pills .nav-link {
        color: #555 !important;
        background: rgba(255, 255, 255, 0.5);
        border: 1px solid rgba(139, 0, 0, 0.2);
        border-radius: 100px;
        padding: 8px 25px !important;
        font-weight: 600;
        transition: all 0.3s ease;
    }
    
    .visit-section .nav-pills .nav-link:hover {
        background: rgba(139, 0, 0, 0.05);
        border-color: #8B0000;
        color: #8B0000 !important;
        transform: translateY(-2px);
    }
    
    .visit-section .nav-pills .nav-link.active {
        background: #8B0000 !important;
        color: white !important;
        border-color: #8B0000;
        box-shadow: 0 4px 15px rgba(139, 0, 0, 0.3);
    }
    
    .visit-section .nav-pills .nav-link.active::after {
        display: none; /* Hide the underline effect from site.css */
    }

    /* ===== ABOUT SECTION PREMIUM OVERLAY ===== */
    .about-image-text-overlay {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        padding: 1.5rem !important;
        background: linear-gradient(to top, rgba(0,0,0,0.6) 0%, transparent 100%);
        color: white;
        pointer-events: none;
        border-bottom-left-radius: 1.5rem;
        border-bottom-right-radius: 1.5rem;
    }

    .about-overlay-title {
        font-family: var(--font-heading);
        font-size: 1.5rem;
        text-shadow: 1px 1px 5px rgba(0,0,0,0.5);
        margin: 0;
        line-height: 1.2;
    }

    @@media (max-width: 768px) {
        .about-overlay-title {
            font-size: 1.6rem;
        }
    }

    /* Custom Icon Coloration */
    .feature-icon-custom {
        display: inline-block;
        width: 1.75rem; /* Match Bootstrap icon size roughly */
        height: 1.75rem;
        background-color: var(--color-secondary);
        -webkit-mask-size: contain;
        mask-size: contain;
        -webkit-mask-repeat: no-repeat;
        mask-repeat: no-repeat;
        -webkit-mask-position: center;
        mask-position: center;
        flex-shrink: 0;
    }

    .about-features .feature-box {
        display: flex;
        align-items: center;
        height: 100%;
        min-height: 80px; /* Slightly taller for better spacing */
        padding: 1rem 1.25rem !important;
        transition: var(--transition-smooth);
        border: 1px solid rgba(212, 175, 55, 0.2) !important;
        background: rgba(255, 255, 255, 0.5) !important;
    }

    .about-features .feature-box:hover {
        background: rgba(255, 255, 255, 0.9) !important;
        transform: translateY(-3px);
        box-shadow: var(--shadow-sm);
        border-color: var(--color-secondary) !important;
    }

    .about-features .icon-container {
        width: 45px; /* Fixed container width */
        height: 45px;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        background: rgba(212, 175, 55, 0.1);
        border-radius: 12px;
    }

    .about-features .feature-icon-custom {
        width: 1.5rem;
        height: 1.5rem;
    }

    .about-features .bi {
        font-size: 1.5rem;
    }

    .about-features .feature-title {
        font-size: 0.75rem;
        font-weight: 700;
        text-uppercase: true;
        letter-spacing: 0.5px;
        line-height: 1.2;
    }
</style>


@{
    var validBanners = Model.Banners.Where(b => !string.IsNullOrEmpty(b.ImageUrl)).ToList();
}
@if (validBanners.Any())
{
    <div id="bannerCarousel" class="carousel slide carousel-fade" data-bs-ride="carousel" data-bs-interval="5000">
        @if (validBanners.Count > 1)
        {
            <div class="carousel-indicators">
                @for (int i = 0; i < validBanners.Count; i++)
                {
                    <button type="button" data-bs-target="#bannerCarousel" data-bs-slide-to="@i"
                            class="@(i == 0 ? "active" : "")"
                            aria-current="@(i == 0 ? "true" : "false")"
                            aria-label="Slide @(i + 1)"></button>
                }
            </div>
        }
        <div class="carousel-inner">
            @for (int i = 0; i < validBanners.Count; i++)
            {
                var banner = validBanners[i];
                <div class="carousel-item @(i == 0 ? "active" : "")">
                    <div class="banner-slide" style="background-image: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('@banner.ImageUrl');">
                        <div class="banner-content">
                            <div class="container text-center">
                                <h1 class="banner-title animate-fade-in">@banner.Title</h1>
                                <p class="banner-description animate-slide-up">@banner.Description</p>
                                @if (!string.IsNullOrEmpty(banner.Link))
                                {
                                    <a href="@banner.Link" class="btn btn-primary btn-lg mt-3 animate-slide-up-delay">
                                        <i class="bi bi-arrow-right-circle me-2"></i>Khám phá ngay
                                    </a>
                                }
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
        @if (validBanners.Count > 1)
        {
            <button class="carousel-control-prev" type="button" data-bs-target="#bannerCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#bannerCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        }
    </div>
}
else
{
    <!-- FALLBACK: HERO SECTION -->
    <section class="hero-section">
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <div class="container text-center">
                <h1 class="hero-logo animate-fade-in">O' BeefSoup</h1>
                <p class="hero-slogan animate-slide-up">Tinh hoa phở Việt – Đậm vị từ tâm</p>
                <div class="hero-buttons animate-slide-up-delay">
                    <a href="#menu" class="btn btn-primary btn-lg me-3">
                        <i class="bi bi-book me-2"></i>Xem thực đơn
                    </a>
                    <a asp-controller="Cart" asp-action="Index" class="btn btn-outline-light btn-lg">
                        <i class="bi bi-cart me-2"></i>Giỏ hàng
                    </a>
                </div>
            </div>
        </div>
        <div class="scroll-indicator">
            <i class="bi bi-chevron-down"></i>
        </div>
    </section>
}


<!-- SEAMLESS BACKGROUND WRAPPER FOR MAIN SECTIONS -->
<div class="seamless-bg-container">
    <!-- SECTION 2: BRAND INTRODUCTION -->
    <section id="about" class="about-section py-5 animate-on-scroll">
    <div class="container">
        <div class="row align-items-center g-5">
            <div class="col-lg-6">
                <div class="about-image-wrapper p-3 position-relative" style="border-radius: 30px;">
                    <img src="@Model.AboutImageUrl" alt="@Model.AboutTitle2" class="img-fluid rounded-4 shadow-lg" style="width:100%; height:auto; display:block; object-fit:cover;">
                    @if (!string.IsNullOrEmpty(Model.AboutTitle1))
                    {
                        <div class="about-image-text-overlay p-4 p-md-5 d-flex flex-column">
                            <h3 class="about-overlay-title">@Model.AboutTitle1</h3>
                        </div>
                    }
                </div>
            </div>
            <div class="col-lg-6">
                <div class="section-header mb-4 text-center text-lg-start">
                    <span class="cta-subtitle mb-2" style="text-align: inherit; margin: 0 auto 15px;">@Model.AboutSubtitle</span>
                    <h2 class="section-title" style="font-family: var(--font-heading); font-style: italic; font-size: 3.5rem;">@Model.AboutTitle2</h2>
                </div>
                <p class="lead mb-4 fw-medium text-center text-lg-start" style="color: var(--color-accent); font-family: var(--font-heading);">
                    @Model.AboutDescription
                </p>
                <div class="about-features mt-5">
                    <div class="row g-3 g-md-4 align-items-stretch">
                        @foreach (var feature in Model.AboutFeatures)
                        {
                            <div class="col-6 mb-3 mb-md-0">
                                <div class="feature-box h-100 border rounded-4">
                                    <div class="icon-container me-3">
                                        @if (!string.IsNullOrEmpty(feature.IconImageUrl))
                                        {
                                            <span class="feature-icon-custom" style="-webkit-mask-image: url('@feature.IconImageUrl'); mask-image: url('@feature.IconImageUrl');"></span>
                                        }
                                        else
                                        {
                                            <i class="bi @(feature.IconClass ?? "bi-star-fill")" style="color: var(--color-secondary);"></i>
                                        }
                                    </div>
                                    <span class="feature-title">@feature.Title</span>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- SECTION 3: FEATURED MENU -->
<section id="menu" class="menu-section py-5">
    <div class="container">
        <div class="section-header text-center mb-5">
            <span class="section-subtitle text-uppercase mb-2" style="color: #dc3545; font-size: 0.8rem; letter-spacing: 2px;">Thực đơn</span>
            <h2 class="section-title mb-3" style="font-family: var(--font-heading); color: #8B0000; font-size: 3rem;">Món phở đặc trưng</h2>
            <p class="section-description text-muted">Khám phá các món phở signature của O' BeefSoup</p>
        </div>
        
        <div class="row g-4">
            @foreach (var product in Model.FeaturedProducts)
            {
                <div class="col-6 col-md-4 col-lg-4">
                    <div class="menu-card" 
                         style="cursor: pointer;"
                         onclick="if(!event.target.closest('.add-to-cart-btn')) window.location.href='@Url.Action("Details", "Menu", new { id = product.Id })'">
                        <div class="menu-card-image">
                            <img src="@product.ImageUrl" alt="@product.Name" class="img-fluid">
                            <div class="menu-card-overlay">
                                <button class="btn btn-light btn-sm add-to-cart-btn" 
                                        onclick="event.stopPropagation();"
                                        data-product-id="@product.Id"
                                        data-product-name="@product.Name"
                                        data-product-price="@product.Price">
                                    <i class="bi bi-cart-plus me-1"></i> Thêm vào giỏ
                                </button>
                            </div>
                        </div>
                        <div class="menu-card-body text-center p-3">
                            <h4 class="menu-card-title fst-italic fw-bold mb-2" style="color: #333; font-size: 1.1rem;">@product.Name</h4>
                            <p class="menu-card-description text-muted small mb-3">@product.Description</p>
                            <div class="d-flex justify-content-between align-items-center mt-auto px-1">
                                <span class="menu-card-price fw-bold" style="color: #8B1A1A; font-size: 1rem;">@product.Price.ToString("N0")đ</span>
                                <button class="btn btn-outline-danger contact-btn-circle add-to-cart-btn"
                                        onclick="event.stopPropagation();"
                                        data-product-id="@product.Id"
                                        data-product-name="@product.Name"
                                        data-product-price="@product.Price"
                                        style="width: 35px; height: 35px; border-radius: 50%; padding: 0; display: flex; align-items: center; justify-content: center; border-color: #ced4da; color: #8B1A1A;">
                                    <i class="bi bi-cart"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
        
        <div class="text-center mt-5">
            <a asp-controller="Menu" asp-action="Index" class="btn btn-primary btn-lg" style="background-color: #8B0000; border: none; padding: 12px 30px;">
                Xem thực đơn đầy đủ
                <i class="bi bi-arrow-right ms-2"></i>
            </a>
        </div>
    </div>
</section>

    <!-- SECTION 4: WHY CHOOSE US - BENTO GRID LAYOUT -->
    <section id="why-us" class="why-section py-5 animate-on-scroll">
        <div class="container">
            <div class="section-header text-center mb-5">
                <span class="section-subtitle">Vì sao là O' BeefSoup?</span>
                <h2 class="section-title">Tinh hoa trong từng trải nghiệm</h2>
            </div>
            
            <div class="bento-grid">
                @if (Model.WhyUsItems.Any())
                {
                    @foreach (var item in Model.WhyUsItems)
                    {
                        <div class="bento-item item-@item.Size">
                            <div class="why-card @(!string.IsNullOrEmpty(item.BackgroundImageUrl) ? "has-bg" : "")" 
                                 style="@(!string.IsNullOrEmpty(item.BackgroundImageUrl) ? $"background-image: url('{item.BackgroundImageUrl}');" : "")">
                                @if (!string.IsNullOrEmpty(item.BackgroundImageUrl))
                                {
                                    <div class="why-card-overlay"></div>
                                }
                                <div class="why-content">
                                    <div class="why-icon"><i class="bi @item.IconClass"></i></div>
                                    <h5 class="why-title">@item.Title</h5>
                                    @if (!string.IsNullOrEmpty(item.Description))
                                    {
                                        <p class="why-description">@item.Description</p>
                                    }
                                </div>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="bento-item item-large">
                        <div class="why-card">
                            <div class="why-icon"><i class="bi bi-award-fill"></i></div>
                            <h5 class="why-title">Bò tươi mỗi ngày</h5>
                            <p class="why-description">Thịt bò được chọn lọc khắt khe từ những trang trại uy tín, đảm bảo độ tươi ngon nhất khi đến bàn ăn.</p>
                        </div>
                    </div>
                    <div class="bento-item item-medium">
                        <div class="why-card">
                            <div class="why-icon"><i class="bi bi-flame"></i></div>
                            <h5 class="why-title">Nước dùng 12h</h5>
                            <p class="why-description">Hương vị đậm đà được tinh chế qua 12 giờ ninh xương.</p>
                        </div>
                    </div>
                    <div class="bento-item item-small">
                        <div class="why-card">
                            <div class="why-icon"><i class="bi bi-shield-check"></i></div>
                            <h5 class="why-title">Nguyên liệu sạch</h5>
                        </div>
                    </div>
                    <div class="bento-item item-accent">
                        <div class="why-card">
                            <div class="why-icon"><i class="bi bi-stars"></i></div>
                            <h5 class="why-title">Không gian sang trọng</h5>
                            <p class="why-description">Sự kết hợp giữa nét truyền thống và hiện đại.</p>
                        </div>
                    </div>
                }
            </div>
        </div>
    </section>

@if (Model.Stores.Any())
{
    <!-- SECTION: GHÉ THĂM CHÚNG TÔI -->
    <section id="visit-us" class="visit-section py-5 animate-on-scroll">
        <div class="container">
            <div class="section-header text-center mb-5">
                <span class="section-subtitle">Tìm chúng tôi</span>
                <h2 class="section-title">Ghé thăm chúng tôi</h2>
            </div>

            @if (Model.Stores.Count == 1)
            {
                <!-- Layout 1 cơ sở: info bên trái, map bên phải -->
                var s = Model.Stores[0];
                <div class="row align-items-center g-4">
                    <div class="col-lg-5">
                        <div class="store-info-card p-4 rounded-4">
                            <h4 class="fw-bold mb-3" style="color:#8B0000;">
                                <i class="bi bi-geo-alt-fill me-2"></i>@s.Name
                            </h4>
                            @if (!string.IsNullOrEmpty(s.Address))
                            {
                                <p class="mb-2"><i class="bi bi-map me-2 text-muted"></i>@s.Address</p>
                            }
                            @if (!string.IsNullOrEmpty(s.OpeningHours))
                            {
                                <p class="mb-3"><i class="bi bi-clock me-2 text-muted"></i>@s.OpeningHours</p>
                            }
                            <div class="d-flex flex-wrap gap-2 mt-3">
                                @if (!string.IsNullOrEmpty(s.Phone))
                                {
                                    <a href="tel:@s.Phone" class="btn btn-outline-danger rounded-pill">
                                        <i class="bi bi-telephone-fill me-1"></i>Gọi ngay
                                    </a>
                                }
                                @if (!string.IsNullOrEmpty(s.Email))
                                {
                                    <a href="mailto:@s.Email" class="btn btn-outline-secondary rounded-pill">
                                        <i class="bi bi-envelope me-1"></i>Email
                                    </a>
                                }
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-7">
                        @if (!string.IsNullOrEmpty(s.MapUrl))
                        {
                            <iframe src="@s.MapUrl" width="100%" height="350"
                                    class="rounded-4 shadow"
                                    style="border:0;" allowfullscreen loading="lazy"></iframe>
                        }
                    </div>
                </div>
            }
            else
            {
                <!-- Layout nhiều cơ sở: tab chọn cơ sở + map + info -->
                <ul class="nav nav-pills justify-content-center mb-4 gap-2" id="storeTabs" role="tablist">
                    @for (int i = 0; i < Model.Stores.Count; i++)
                    {
                        <li class="nav-item" role="presentation">
                            <button class="nav-link @(i == 0 ? "active" : "")"
                                    id="store-tab-@i"
                                    data-bs-toggle="pill"
                                    data-bs-target="#store-pane-@i"
                                    type="button" role="tab">
                                <i class="bi bi-geo-alt me-1"></i>@Model.Stores[i].Name
                            </button>
                        </li>
                    }
                </ul>
                <div class="tab-content" id="storeTabContent">
                    @for (int i = 0; i < Model.Stores.Count; i++)
                    {
                        var s = Model.Stores[i];
                        <div class="tab-pane fade @(i == 0 ? "show active" : "")"
                             id="store-pane-@i" role="tabpanel">
                            <div class="row align-items-center g-4">
                                <div class="col-lg-5">
                                    <div class="store-info-card p-4 rounded-4">
                                        <h4 class="fw-bold mb-3" style="color:#8B0000;">
                                            <i class="bi bi-geo-alt-fill me-2"></i>@s.Name
                                        </h4>
                                        @if (!string.IsNullOrEmpty(s.Address))
                                        {
                                            <p class="mb-2"><i class="bi bi-map me-2 text-muted"></i>@s.Address</p>
                                        }
                                        @if (!string.IsNullOrEmpty(s.City))
                                        {
                                            <p class="mb-2"><i class="bi bi-building me-2 text-muted"></i>@s.City</p>
                                        }
                                        @if (!string.IsNullOrEmpty(s.OpeningHours))
                                        {
                                            <p class="mb-3"><i class="bi bi-clock me-2 text-muted"></i>@s.OpeningHours</p>
                                        }
                                        <div class="d-flex flex-wrap gap-2 mt-3">
                                            @if (!string.IsNullOrEmpty(s.Phone))
                                            {
                                                <a href="tel:@s.Phone" class="btn btn-outline-danger rounded-pill">
                                                    <i class="bi bi-telephone-fill me-1"></i>Gọi ngay
                                                </a>
                                            }
                                            @if (!string.IsNullOrEmpty(s.Email))
                                            {
                                                <a href="mailto:@s.Email" class="btn btn-outline-secondary rounded-pill">
                                                    <i class="bi bi-envelope me-1"></i>Email
                                                </a>
                                            }
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-7">
                                    @if (!string.IsNullOrEmpty(s.MapUrl))
                                    {
                                        <iframe src="@s.MapUrl" width="100%" height="350"
                                                class="rounded-4 shadow"
                                                style="border:0;" allowfullscreen loading="lazy"></iframe>
                                    }
                                    else
                                    {
                                        <div class="bg-light rounded-4 d-flex align-items-center justify-content-center"
                                             style="height:350px;">
                                            <div class="text-center text-muted">
                                                <i class="bi bi-map fs-1 d-block mb-2"></i>
                                                <small>Bản đồ chưa được cập nhật</small>
                                            </div>
                                        </div>
                                    }
                                </div>
                            </div>
                        </div>
                    }
                </div>
            }
        </div>
    </section>

    <style>
        .visit-section { background: #fafafa; }
        .store-info-card {
            background: #fff;
            border: 1px solid rgba(139,0,0,0.1);
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
        }
        #storeTabs .nav-link {
            border: 2px solid rgba(139,0,0,0.3);
            color: #8B0000;
            border-radius: 50px;
            padding: 8px 20px;
            font-weight: 600;
        }
        #storeTabs .nav-link.active {
            background: #8B0000;
            border-color: #8B0000;
            color: #fff;
        }
    </style>
}

<!-- SECTION 5: CUSTOMER TESTIMONIALS -->

<section id="testimonials" class="testimonials-section py-5 animate-on-scroll">
    <div class="container">
        <div class="section-header text-center mb-5">
            <span class="section-subtitle text-uppercase mb-2" style="color: #dc3545; font-size: 0.8rem; letter-spacing: 2px;">Phản hồi</span>
            <h2 class="section-title mb-3" style="font-family: var(--font-heading); color: #8B0000; font-size: 3rem;">Khách hàng nói gì về chúng tôi</h2>
        </div>
        
        <div class="row g-4 mt-2">
            @foreach (var testimonial in Model.Testimonials)
            {
                <div class="col-6 col-md-4">
                    <div class="testimonial-card h-100 p-4">
                        <div class="testimonial-rating mb-3">
                            @for (int i = 1; i <= 5; i++)
                            {
                                <i class="bi bi-star-fill" style="color: @(i <= testimonial.Rating ? "var(--color-secondary)" : "#e0e0e0"); font-size: 0.8rem;"></i>
                            }
                        </div>
                        <p class="testimonial-comment mb-4" style="font-family: var(--font-heading); font-style: italic; font-size: 1.1rem; line-height: 1.6;">
                            "@testimonial.Comment"
                        </p>
                        <div class="testimonial-author d-flex align-items-center mt-auto">
                            <div class="author-avatar me-3">
                                <img src="https://ui-avatars.com/api/?name=@testimonial.CustomerName&background=d4af37&color=000" class="rounded-circle" style="width: 45px; height: 45px; border: 1px solid var(--color-secondary);" alt="@testimonial.CustomerName">
                            </div>
                            <div class="author-info">
                                <h6 class="author-name mb-0 fw-bold" style="font-size: 0.9rem; color: var(--color-secondary);">@testimonial.CustomerName</h6>
                                <p class="author-date mb-0 x-small" style="font-size: 0.75rem; opacity: 0.5;">@testimonial.Date.ToString("dd/MM/yyyy")</p>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>

        <div class="text-center mt-5">
            @if (!string.IsNullOrEmpty(Context.Session.GetString("CustomerName")))
            {
                <button type="button" class="btn btn-premium-gold shadow-sm" data-bs-toggle="modal" data-bs-target="#reviewModal">
                    <i class="bi bi-pencil-square me-2"></i>Gửi đánh giá của bạn
                </button>
            }
            else
            {
                <a asp-controller="CustomerAccount" asp-action="Login" asp-route-returnUrl="@Context.Request.Path" class="btn btn-outline-danger rounded-pill px-4">
                    Đăng nhập để viết đánh giá
                </a>
            }
        </div>
    </div>
</section>

<!-- Review Modal -->
<div class="modal fade" id="reviewModal" tabindex="-1" aria-labelledby="reviewModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow-lg" style="border-radius: 20px;">
            <div class="modal-header bg-light border-0" style="border-radius: 20px 20px 0 0; padding: 25px;">
                <h5 class="modal-title fw-bold" id="reviewModalLabel" style="color: #8B0000;">
                    <i class="bi bi-star-fill me-2 text-warning"></i>Chia sẻ cảm nhận của bạn
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="reviewForm">
                @Html.AntiForgeryToken()
                <div class="modal-body p-4">
                    <div class="mb-4 text-center">
                        <label class="form-label d-block mb-3 fw-bold">Bạn đánh giá chất lượng thế nào?</label>
                        <div class="star-rating fs-2">
                            <i class="bi bi-star star-btn" data-value="1"></i>
                            <i class="bi bi-star star-btn" data-value="2"></i>
                            <i class="bi bi-star star-btn" data-value="3"></i>
                            <i class="bi bi-star star-btn" data-value="4"></i>
                            <i class="bi bi-star star-btn" data-value="5"></i>
                            <input type="hidden" name="rating" id="ratingInput" value="5" required>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="comment" class="form-label fw-bold">Nội dung đánh giá</label>
                        <textarea class="form-control border-0 bg-light" id="comment" name="comment" rows="4" 
                                  placeholder="Hãy chia sẻ trải nghiệm của bạn về món ăn và dịch vụ..." 
                                  style="border-radius: 12px; resize: none;" required></textarea>
                    </div>
                </div>
                <div class="modal-footer border-0 p-4 pt-0">
                    <button type="button" class="btn btn-light rounded-pill px-4" data-bs-dismiss="modal">Hủy</button>
                    <button type="submit" class="btn btn-premium-gold rounded-pill px-4">Gửi đánh giá</button>
                </div>
            </form>
        </div>
    </div>
</div>

<style>
    .star-rating .bi-star, .star-rating .bi-star-fill {
        cursor: pointer;
        color: #ddd;
        transition: all 0.2s;
        margin: 0 4px;
    }
    .star-rating .bi-star.active, .star-rating .bi-star-fill.active {
        color: #FFD700;
        transform: scale(1.2);
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const stars = document.querySelectorAll('.star-btn');
        const ratingInput = document.getElementById('ratingInput');
        
        function updateStars(val) {
            stars.forEach(s => {
                const sVal = parseInt(s.getAttribute('data-value'));
                if (sVal <= val) {
                    s.classList.remove('bi-star');
                    s.classList.add('bi-star-fill', 'active');
                } else {
                    s.classList.remove('bi-star-fill', 'active');
                    s.classList.add('bi-star');
                }
            });
        }
        
        // Default 5 stars
        updateStars(5);
        
        stars.forEach(star => {
            star.addEventListener('click', function() {
                const val = parseInt(this.getAttribute('data-value'));
                ratingInput.value = val;
                updateStars(val);
            });
        });

        // AJAX Submission
        const form = document.getElementById('reviewForm');
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(form);
            
            fetch('/Testimonials/Submit', {
                method: 'POST',
                body: formData,
                headers: {
                    'RequestVerificationToken': document.querySelector('input[name="__RequestVerificationToken"]').value
                }
            })
            .then(response => response.json())
            .then(data => {
                const modal = bootstrap.Modal.getInstance(document.getElementById('reviewModal'));
                modal.hide();
                
                if (data.success) {
                    alert(data.message);
                    form.reset();
                    updateStars(5);
                } else {
                    alert('Lỗi: ' + data.message);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Có lỗi xảy ra khi gửi đánh giá.');
            });
        });
    });
</script>

<!-- SECTION 6: FINAL CTA -->
<section id="reservation" class="cta-section animate-on-scroll">
    <div class="cta-overlay"></div>
    <div class="container text-center">
        <div class="cta-box">
            <span class="cta-subtitle">Trải nghiệm thượng lưu</span>
            <div class="cta-divider"></div>
            <h2 class="cta-title">Sẵn sàng thưởng thức <br/> tô phở đậm vị?</h2>
            <div class="cta-buttons mt-4">
                <a asp-controller="Menu" asp-action="Index" class="btn btn-premium-gold">
                    <i class="bi bi-telephone-fill me-2"></i>Đặt món ngay
                </a>
            </div>
        </div>
    </div>
</section>


<style>
    .animate-on-scroll {
        opacity: 0;
        transform: translateY(30px);
        transition: all 0.8s cubic-bezier(0.23, 1, 0.32, 1);
    }
    .animate-on-scroll.is-visible {
        opacity: 1 !important;
        transform: translateY(0) !important;
    }
</style>

<!-- SECTION 7: RECENT BLOG POSTS -->
@if (Model.RecentBlogPosts != null && Model.RecentBlogPosts.Any())
{
    <section id="blog" class="py-5 show-bg animate-on-scroll">
        <div class="container">
            <div class="section-header text-center mb-5">
                <span class="section-subtitle">Blog & Tin tức</span>
                <h2 class="section-title">Tin tức & Sự kiện mới nhất</h2>
                <p class="text-muted">Cập nhật tin tức khuyến mãi và văn hóa ẩm thực tại O' BeefSoup</p>
            </div>

            <div class="row g-3 g-md-4">
                @foreach (var post in Model.RecentBlogPosts)
                {
                    <div class="col-6 col-md-4">
                        <div class="card h-100 border-0 shadow-sm blog-card-home" style="border-radius: 15px; overflow: hidden; background: #fff;">
                            <div class="position-relative overflow-hidden blog-image-container" style="height: 180px;">
                                @if (!string.IsNullOrEmpty(post.ImageUrl))
                                {
                                    <img src="@post.ImageUrl" class="card-img-top h-100 w-100" alt="@post.Title" style="object-fit: cover; transition: transform 0.8s ease;">
                                }
                                else
                                {
                                    <div class="bg-light d-flex align-items-center justify-content-center h-100">
                                        <i class="bi bi-image text-muted fs-1"></i>
                                    </div>
                                }
                                <div class="position-absolute top-0 end-0 bg-dark text-white px-2 py-0 small m-2 rounded-pill fw-bold" style="background: rgba(0,0,0,0.6) !important; backdrop-filter: blur(5px); font-size: 0.65rem;">
                                    @post.CreatedDate.ToString("dd MMM")
                                </div>
                            </div>
                            <div class="card-body p-3">
                                <h6 class="fw-bold mb-2 blog-title-mobile" style="font-family: var(--font-heading); font-style: italic; line-height: 1.2;">
                                    <a asp-controller="Blog" asp-action="Details" asp-route-slug="@post.Slug" class="text-decoration-none text-dark hover-gold">
                                        @post.Title
                                    </a>
                                </h6>
                                <p class="text-muted small mb-0 lh-sm d-none d-md-block">@post.Summary</p>
                            </div>
                        </div>
                    </div>
                }
            </div>

            <div class="text-center mt-5">
                <a asp-controller="Blog" asp-action="Index" class="btn btn-outline-primary px-4 py-2">
                    Xem tất cả bài viết <i class="bi bi-arrow-right ms-1"></i>
                </a>
            </div>
        </div>
    </section>

    <style>
        .blog-card-home { transition: transform 0.3s ease; }
        .blog-card-home:hover { transform: translateY(-5px); }
        .blog-card-home h5 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .blog-card-home p { display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
        
        @@media (max-width: 768px) {
            .blog-image-container {
                height: 120px !important;
            }
            .blog-title-mobile {
                font-size: 0.8rem !important;
                -webkit-line-clamp: 2;
                display: -webkit-box;
                -webkit-box-orient: vertical;
                overflow: hidden;
            }
        }
    </style>
}




@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Intersection Observer for Scroll Reveal
            const observerOptions = {
                threshold: 0.05,
                rootMargin: '0px 0px -100px 0px'
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    console.log('Checking entry:', entry.target.id, 'Intersecting:', entry.isIntersecting);
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                    }
                });
            }, observerOptions);

            document.querySelectorAll('.animate-on-scroll').forEach((el) => {
                observer.observe(el);
            });

            // Back to Top Button Logic
            const backToTopBtn = document.getElementById('backToTop');
            
            window.addEventListener('scroll', function() {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('show');
                } else {
                    backToTopBtn.classList.remove('show');
                }
            });

            backToTopBtn.addEventListener('click', function() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
        });
    </script>
}

<!-- Back to Top Button -->
<button id="backToTop" class="back-to-top-btn" title="Về đầu trang">
    <i class="bi bi-arrow-up"></i>
</button>

<style>
    .back-to-top-btn {
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: #8B1A1A;
        color: white;
        border: 2px solid #D4AF37;
        box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        cursor: pointer;
        z-index: 9999;
        opacity: 0;
        visibility: hidden;
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        transform: translateY(20px);
    }

    .back-to-top-btn.show {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
    }

    .back-to-top-btn:hover {
        background: #D4AF37;
        color: #8B1A1A;
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(212, 175, 55, 0.4);
    }

    @@media (max-width: 768px) {
        .back-to-top-btn {
            bottom: 20px;
            right: 20px;
            width: 45px;
            height: 45px;
            font-size: 1.2rem;
        }
    }
</style>

